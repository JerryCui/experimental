/*! Cordova for Chrome - v0.1.0 - 2012-11-12
* http://github.com/MobileChromeApps/
* Copyright (c) 2012 Google Inc.; Licensed MIT */
(function(){function r(e){return function(){console.warn("API is not supported on mobile: "+e)}}function i(e,t){var n=e.split("."),r=window;for(var i=0,s;s=n[i++];)i==n.length?r[s]=t:r[s]?r=r[s]:r=r[s]={}}if(window.chrome&&chrome.mobile){console.log("WARNING - chrome apis doubly included.");return}var e,t,n={};(function(){t=function(t,r){if(n[t]){console.log("WARNING - duplicate definition of module: "+t);return}n[t]=r};var r={};e=function i(e){var t=n[e];if(!t){console.error("No such module: "+e);return}if(r[e]){console.error("Circular require(): "+e+" included twice.");return}if(typeof t=="function"){r[e]=!0;var s={};return s.exports={},t(i,s),n[e]=s,delete r[e],s.exports}if(typeof t=="object")return t.exports;console.error("unsupported module type: "+typeof t)}})(),t("chrome.app.runtime",function(e,t){var n=e("helpers.events"),r=t.exports;r.onLaunched={},r.onLaunched.addListener=n.addListener("onLaunched"),r.onLaunched.fire=n.fire("onLaunched")}),t("chrome.app.window",function(e,t){function a(){this.contentWindow=i.fgWindow,this.id=""}function f(e,t){var n=e.attributes;for(var r=0,i;i=n[r];++r)t.setAttribute(i.name,i.value)}function l(e,t){u.innerHTML="<a "+e+">",f(u.firstChild,t)}function c(e){var t=e.getElementsByTagName("script"),n=e.ownerDocument;for(var r=0,i;i=t[r];++r){var s=n.createElement("script");f(i,s),i.parentNode.replaceChild(s,i)}}function h(e){var t=i.fgWindow.document.body,n=t.previousElementSibling,r=e.search(/<html([\s\S]*?)>/i);if(r==-1)i.eventIframe.insertSiblingHTML(e);else{r+=RegExp.lastMatch.length,l(RegExp.lastParen,t.parentNode);var s=e.search(/<\/head\s*>/i),o=e.slice(r,s);e=e.slice(s+RegExp.lastMatch.length),o=o.replace(/<head\b([\s\S]*?)>/i,""),l(RegExp.lastParen,n),o='<link rel="stylesheet" href="chromeappstyles.css">\n'+o,n.innerHTML=o,c(n),e.search(/<body([\s\S]*?)>/i),l(RegExp.lastParen,t),i.eventIframe.insertAdjacentHTML("afterend",e),c(t)}}var n=e("helpers.events"),i=e("chrome.mobile.impl"),s=t.exports,o=null,u=document.createElement("a");a.prototype={restore:r("AppWindow.restore"),moveTo:r("AppWindow.moveTo"),clearAttention:r("AppWindow.clearAttention"),minimize:r("AppWindow.minimize"),drawAttention:r("AppWindow.drawAttention"),focus:r("AppWindow.focus"),resizeTo:r("AppWindow.resizeTo"),maximize:r("AppWindow.maximize"),close:r("AppWindow.close"),onClosed:{addListener:n.addListener("onClosed")}},s.create=function(e,t,n){if(o){console.log("ERROR - chrome.app.window.create called multiple times. This is unsupported.");return}o=new a;var r=new XMLHttpRequest;r.open("GET",e,!0),r.onreadystatechange=function(){if(r.readyState==4){n&&n(o);var e=r.responseText||"Page load failed.";h(e),cordova.fireWindowEvent("DOMContentReady"),cordova.fireWindowEvent("load")}},r.send()},s.current=function(){return window==i.fgWindow?o:null}}),t("chrome.mobile.impl",function(e,t){var n=t.exports;n.init=function(e,t){n.fgWindow=e,n.bgWindow=t.contentWindow,n.eventIframe=t,n.bgWindow.chrome=window.chrome}}),t("chrome.runtime",function(e,t){var n=e("helpers.events"),r=t.exports;r.onSuspend={},r.onSuspend.fire=n.fire("onSuspend"),r.onSuspend.addListener=function(e){window.document.addEventListener("pause",r.onSuspend.fire,!1);var t=n.addListener("onSuspend");console.log("sub-handler type: "+typeof t),r.onSuspend.addListener=t,r.onSuspend.addListener(e)}}),t("chrome.storage",function(e,t){function n(){}function i(){this.newValue=null,this.oldValue=null}n.prototype={getBytesInUse:r("StorageArea.getBytesInUse")},n.prototype.clear=function(e){localStorage.clear(),e&&e()},n.prototype.set=function(e,t){for(var n in e)localStorage.setItem(n,JSON.stringify(e[n]));t&&t()},n.prototype.remove=function(e,t){typeof e=="string"&&(e=[e]);for(var n in e)localStorage.removeItem(n);t&&t()},n.prototype.get=function(e,t){if(typeof e=="function"){t=e,e={};for(var n=0;n<localStorage.length;n++)e[localStorage.key(n)]=null}else if(typeof e=="string"){var r=e;e={},e[r]=null}else if(Object.prototype.toString.call(e)==="[object Array]"){var i={};e.forEach(function(e){i[e]=null}),e=i}for(var s in e){var o=localStorage.getItem(s);o!=null&&(e[s]=JSON.parse(o))}t&&t(e)},i.prototype={};var s=new n;s.QUOTA_BYTES=5242880;var o=new n;o.MAX_ITEMS=512,o.MAX_WRITE_OPERATIONS_PER_HOUR=1e3,o.QUOTA_BYTES_PER_ITEM=4096,o.MAX_SUSTAINED_WRITE_OPERATIONS_PER_MINUTE=10,o.QUOTA_BYTES=102400;var u=t.exports;u.local=s,u.sync=o;var a=e("helpers.events");u.onChanged={},u.onChanged.addListener=a.addListener("onChanged"),u.onChanged.fire=a.fire("onChanged")}),t("helpers.events",function(e,t){var n={};t.exports.addListener=function(e){return function(t){n[e]?n[e].push(t):n[e]=[t]}},t.exports.fire=function(e){return function(){for(var t=0;t<n[e].length;t++)n[e][t]()}}}),chrome={};for(var s in n)s.indexOf("chrome.")==0&&i(s,e(s))})();